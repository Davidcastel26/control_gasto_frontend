<section class="space-y-6">
  <header>
    <h2 class="text-xl font-semibold">Comparative Budget vs Execution</h2>
    <p class="text-sm text-slate-400">Consulta por rango de fechas y (opcional) usuario.</p>
  </header>

  <form [formGroup]="form" class="grid grid-cols-1 md:grid-cols-4 gap-4" (ngSubmit)="load()">
    <div>
      <label class="block text-sm mb-1">Desde</label>
      <input
        type="date"
        class="w-full rounded-md bg-slate-900 border border-slate-700 px-3 py-2"
        formControlName="desde"
      />
    </div>

    <div>
      <label class="block text-sm mb-1">Hasta</label>
      <input
        type="date"
        class="w-full rounded-md bg-slate-900 border border-slate-700 px-3 py-2"
        formControlName="hasta"
      />
    </div>

    <div>
      <label class="block text-sm mb-1">Usuario (opcional)</label>
      <input
        type="number"
        class="w-full rounded-md bg-slate-900 border border-slate-700 px-3 py-2"
        formControlName="usuarioId"
        placeholder="Ej: 1"
      />
    </div>

    <div class="flex items-end">
      <button
        type="submit"
        class="px-3 py-2 rounded-md bg-sky-600 hover:bg-sky-500 text-sm font-medium"
        [disabled]="form.invalid || loading()"
      >
        Consultar
      </button>
    </div>
  </form>

  <div class="rounded-lg border border-slate-800 overflow-hidden">
    <table class="w-full text-sm">
      <thead class="bg-slate-900/70 text-slate-300 border-b border-slate-800">
        <tr>
          <th class="text-left px-4 py-2">Tipo de Gasto</th>
          <th class="text-right px-4 py-2">Presupuestado</th>
          <th class="text-right px-4 py-2">Ejecutado</th>
        </tr>
      </thead>
      <tbody>
        @if (loading()) {
        <tr>
          <td colspan="3" class="px-4 py-4">Cargandoâ€¦</td>
        </tr>
        } @else if (items().length === 0) {
        <tr>
          <td colspan="3" class="px-4 py-4 text-slate-400">Sin datos</td>
        </tr>
        } @else { @for (it of items(); track it.tipoGastoId) {
        <tr class="border-b border-slate-800">
          <td class="px-4 py-2">{{ it.tipoGastoNombre }}</td>
          <td class="px-4 py-2 text-right">{{ it.presupuestado | number : '1.2-2' }}</td>
          <td class="px-4 py-2 text-right">{{ it.ejecutado | number : '1.2-2' }}</td>
        </tr>
        } }
      </tbody>
    </table>
  </div>
</section>
